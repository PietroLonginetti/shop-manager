<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title *ngIf="!isSearchBarOpened">
      Shops
    </ion-title>

    <ion-buttons slot="end" *ngIf="!isSearchBarOpened">
      <ion-button (click)="this.isSearchBarOpened = true; setFocus()">
        <ion-icon name="search"></ion-icon>
      </ion-button>
      <ion-button (click)="presentPopover($event)">
        <ion-icon name="ellipsis-vertical"></ion-icon>
      </ion-button>
    </ion-buttons>

    <ion-searchbar id="shop-searchbar" *ngIf="isSearchBarOpened" animated="true" (ionInput)="findShop()" showCancelButton="true" 
    (ionCancel)="this.isSearchBarOpened = false" placeholder="Find your shop!">
    </ion-searchbar>

  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" scrollEvents="true" [appHideFooter]="add" [hideSpeed]="1">
  <ion-segment (ionChange)="toggleVis($event)" [value]="this.visualization">
    <ion-segment-button value="cards">
      <ion-icon name="albums-sharp"></ion-icon>
    </ion-segment-button>
    <ion-segment-button value="list">
      <ion-icon name="list-sharp"></ion-icon>
    </ion-segment-button>
  </ion-segment>

  <ion-fab #add vertical="bottom" horizontal="center" slot="fixed">
    <ion-fab-button mini (click)="addShop()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>


  <div id="container">
    <div class="inactive" id="shop-cards">
      <ion-card class="active" *ngFor="let shop of shops; let i = index;" routerLink="shop/{{i}}" routerDirection="forward">
        <img [src]="shop.value.imgs[0]">
        <ion-card-header>
          <ion-card-title class="card-title">{{shop.value.name}}</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <div style="width: 80px">
            <ion-icon *ngFor="let star of shop.value.valutation" name="star" class="stars"></ion-icon>
          </div>
          <ion-chip color="primary" outline="true" [disabled]="shop.value.telephone != ''? false : true">
            <ion-icon name="call" style="margin: 0" (click)="callShop($event, i);"></ion-icon>
          </ion-chip>
          <div style="width: 80px; text-align: end;">
            <p class="card-open">{{isOpen(i)?'Now Open':'Now Closed'}}</p>
          </div>
        </ion-card-content>
      </ion-card>
    </div>

    <ion-list class="inactive" id="shop-list" lines="none">
      <ion-item class="active" *ngFor="let shop of shops; let i = index;" routerLink="shop/{{i}}" routerDirection="forward">
        <ion-avatar slot="start"><img [src]="getListAvatar(i)"></ion-avatar>
        <ion-label>{{shop.value.name}}</ion-label>
        <ion-icon *ngFor="let star of shop.value.valutation" name="star" class="stars" style="font-size: 16px;">
        </ion-icon>
      </ion-item>
    </ion-list>
  </div>
</ion-content>